box: node:v9.4.0

initial-build:
  steps:
    # - script:
    #     name: install-packages
    #     code: |
    #       apt-get update
    #       apt-get install -y bzip2

    # - script:
    #     name: setup node env
    #     code: |
    #       export NODE_ENV=development

    - npm-install

release-build:
  steps:
    - script:
        name: setup node env
        code: |
          export NODE_ENV=development

    # Generate relevant artifacts
    - script:
        name: build release code
        code: |
          npm run build

push-release:
  # Override the node:4-slim box
  # box:
  #   id: nginx:alpine
  #   cmd: /bin/sh

  steps:
    - script:
        name: cleanup build result
        code: |
          rm -rf *

    # push container as-is
    - internal/docker-push:
        disable-sync: true
        repository: darkerhp/test_wercker
        